<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analysis of Malware Code (Password & Token Stealer)</title>

  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    body, h1, h2, p, ul, li, a {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
    }

    body {
      background-color: #f4f7fc;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    header {
      background-color: #4CAF50;
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 8px;
    }

    header h1 {
      font-size: 2.5rem;
    }

    section {
      margin: 40px 0;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    section h2 {
      font-size: 2rem;
      color: #4CAF50;
      margin-bottom: 10px;
    }

    section p {
      font-size: 1.1rem;
      line-height: 1.8;
    }

    section ul {
      margin-left: 20px;
      list-style-type: disc;
    }

    section img {
      width: 100%;
      max-width: 600px;
      display: block;
      margin: 20px 0;
      border-radius: 8px;
    }

    a {
      color: #4CAF50;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    a:hover {
      color: #45a049;
      text-decoration: underline;
    }

    .back-button {
      text-align: center;
      margin-top: 30px;
    }

    .back-button a {
      display: inline-block;
      background-color: #4CAF50;
      color: white;
      padding: 12px 24px;
      border-radius: 6px;
      text-decoration: none;
      font-weight: 500;
      font-size: 1.1rem;
      transition: background-color 0.3s ease;
    }

    .back-button a:hover {
      background-color: #45a049;
    }

    footer {
      text-align: center;
      margin-top: 50px;
      font-size: 1rem;
      color: #888;
    }

    footer p {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <header>
    <h1>Analysis of the Malware Code (Password & Token Stealer)</h1>
  </header>

  <section>
    <h2>1. Static Analysis</h2>
    <p>For static analysis, I didn’t run the file yet. I used <strong>DnSpy</strong> to inspect the malware's code since it was a .NET executable.</p>

    <h3>Reviewing Code with DnSpy</h3>
    <p>By opening the file in <strong>DnSpy</strong>, I could read and understand what the malware was coded to do. Some findings:</p>
    <ul>
      <li>There were Discord webhook URLs hardcoded inside.</li>
      <img src="https://raw.githubusercontent.com/MoriDesuu/MoriDesuu.github.io/refs/heads/main/image4.png" alt="Token Grab" />
      <li>Functions that grabbed browser data (like Chrome and Firefox tokens).</li>
      <img src="https://raw.githubusercontent.com/MoriDesuu/MoriDesuu.github.io/refs/heads/main/image2.png" alt="Token Grab" />
      <li>Code that saved stolen data to a local file path like <code>C:\temp\[USER]_Passwords.txt</code>.</li>
      <img src="https://raw.githubusercontent.com/MoriDesuu/MoriDesuu.github.io/main/3.png" alt="Save" />
      <img src="https://raw.githubusercontent.com/MoriDesuu/MoriDesuu.github.io/refs/heads/main/image.png" alt="Save" />
      <li>Used <code>HttpClient</code> or similar to send stolen info to the webhook.</li>
    </ul>

    <h3>VirusTotal Scan</h3>
    <p>I also uploaded the file to <a href="https://www.virustotal.com/" target="_blank">VirusTotal and Hybrid Analysis</a>, and it was flagged by many AVs. Most said it was a stealer or a trojan.</p>
  </section>

  <section>
    <h2>2. Post Analysis</h2>
    <p>After reviewing the code statically, I used a sandbox to see how it behaves when executed.</p>

    <h3>A. Runtime Behavior</h3>
    <p>After running it in a sandbox, it did the following:</p>
    <ul>
      <li>Created a file like <strong>C:\temp\[USER]_Passwords.txt</strong> to store creds.</li>
      <li>Searched local storage files for Discord tokens.</li>
      <li>Sent the data to the webhook.</li>
    </ul>

    <h3>B. Network Behavior</h3>
    <p>I used <strong>App.Any.Run</strong> to monitor network activity. It clearly showed:</p>
    <ul>
      <li>The malware established HTTP connection to a Discord webhook.</li>
      <li>Sent token and password data in plain text.</li>
    </ul>

    <h3>C. Cleanup Behavior</h3>
    <p>It also had some kind of cleanup process:</p>
    <ul>
      <li>Deleted the text file with the stolen data after uploading it.</li>
      <li>Attempted to remove itself from the system afterward.</li>
    </ul>

    <h3>D. Tools Used</h3>
    <ul>
      <li><strong>DnSpy</strong> – for viewing and analyzing the C# code inside the .NET file.</li>
      <li><strong>VirusTotal / Hybrid Analysis</strong> – for scanning and checking known detections.</li>
      <li><strong>App.Any.Run</strong> – to run the malware safely and observe network behavior.</li>
    </ul>
  </section>

  <section>
    <h2>3. Conclusion</h2>
    <p>Based on both static and dynamic analysis, the file is a basic but effective password and token stealer.</p>
    <p>The code clearly shows stealing logic using Discord webhooks, and the sandbox confirmed it behaves the same. It saves stolen data locally, exfiltrates it, then deletes itself. Simple, but dangerous if someone executes it unknowingly.</p>
  </section>

  <section class="back-button">
    <a href="index.html">⬅ Back to Home</a>
  </section>

  <footer>
    <p>&copy; 2025 Aqil Najmi. All Rights Reserved.</p>
  </footer>

</body>
</html>
