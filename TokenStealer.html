<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Analysis of Malware Code (Password & Token Stealer)</title>

  <!-- Google Fonts for typography -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  
  <style>
    /* General styling */
    body, h1, h2, p, ul, li, a {
      margin: 0;
      padding: 0;
      font-family: 'Roboto', sans-serif;
    }

    /* Body and background styling */
    body {
      background-color: #f4f7fc;
      color: #333;
      line-height: 1.6;
      padding: 20px;
    }

    /* Header Styling */
    header {
      background-color: #4CAF50;
      color: white;
      padding: 20px;
      text-align: center;
      border-radius: 8px;
    }

    header h1 {
      font-size: 2.5rem;
    }

    /* Section Styling */
    section {
      margin: 40px 0;
      padding: 20px;
      background-color: #fff;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    section h2 {
      font-size: 2rem;
      color: #4CAF50;
      margin-bottom: 10px;
    }

    section p {
      font-size: 1.1rem;
      line-height: 1.8;
    }

    section ul {
      margin-left: 20px;
      list-style-type: disc;
    }

    section img {
      width: 100%;
      max-width: 600px;
      display: block;
      margin: 20px 0;
      border-radius: 8px;
    }

    /* Links and Buttons */
    a {
      color: #4CAF50;
      text-decoration: none;
      transition: color 0.3s ease;
    }

    a:hover {
      color: #45a049;
      text-decoration: underline;
    }

    /* Footer Styling */
    footer {
      text-align: center;
      margin-top: 50px;
      font-size: 1rem;
      color: #888;
    }

    footer p {
      margin-top: 10px;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header>
    <h1>Analysis of the Malware Code (Password & Token Stealer)</h1>
  </header>

  <!-- Static Analysis Section -->
  <section>
    <h2>1. Static Analysis</h2>
    <p>Static analysis is the first phase of malware analysis, where the file is analyzed without being executed. This helps us understand the structure and functionality of the code. In this case, we used tools like <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>, hex editors, and disassemblers to identify suspicious functions and behavior.</p>
    
    <h3>A. Hex Editor Analysis</h3>
    <p>Using a hex editor like <strong>HxD</strong>, we can examine the file's raw data. Key findings include:</p>
    <ul>
      <li>Presence of embedded URLs, including Discord webhooks used for exfiltration.</li>
      <li>Hardcoded paths for local files like C:\temp\[USERNAME]_Passwords.txt.</li>
      <li>Suspicious strings related to Discord tokens, suggesting the presence of token-stealing functionality.</li>
    </ul>
    
    <h3>B. VirusTotal Scan</h3>
    <p>The malware was scanned on <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a>, which flagged it as a token stealer. The file had multiple detections for keylogger activity and information theft.</p>
    <img src="https://raw.githubusercontent.com/MoriDesuu/MoriDesuu.github.io/main/3.png" alt="VirusTotal Scan Result" />
  </section>

  <!-- Post Analysis Section -->
  <section>
    <h2>2. Post Analysis</h2>
    <p>After static analysis, we move on to dynamic (post) analysis to observe the behavior of the malware in real-time. This phase involves running the malware in a controlled environment (sandbox) to monitor its actions.</p>

    <h3>A. Execution Behavior</h3>
    <p>Upon execution, the malware attempts to:</p>
    <ul>
      <li>Create the file <strong>C:\temp\[USER]_Passwords.txt</strong> to store any stolen passwords.</li>
      <li>Scan the system for stored Discord tokens in browser data files (e.g., Chrome's LocalStorage).</li>
      <li>Exfiltrate the stolen data using a Discord webhook.</li>
    </ul>
    
    <h3>B. Network Activity</h3>
    <p>During post analysis, we used a network monitoring tool like <strong>Wireshark</strong> to capture outgoing traffic. We observed:</p>
    <ul>
      <li>Malware establishing an HTTP connection to a Discord webhook URL.</li>
      <li>Data being sent in plain text, which included Discord tokens and passwords.</li>
    </ul>
    
    <h3>C. Cleanup Mechanisms</h3>
    <p>The malware attempts to cover its tracks by:</p>
    <ul>
      <li>Deleting the local files containing stolen data after exfiltration.</li>
      <li>Attempting to delete the malware executable itself to avoid detection.</li>
    </ul>
    
    <h3>D. Analysis Tools Used</h3>
    <p>The following tools were used to aid in post-analysis:</p>
    <ul>
      <li><strong>Wireshark</strong> - for monitoring network traffic.</li>
      <li><strong>x64dbg</strong> - for debugging the execution process.</li>
      <li><strong>Fiddler</strong> - for intercepting and analyzing HTTP requests.</li>
    </ul>
  </section>

  <!-- Conclusion Section -->
  <section>
    <h2>3. Conclusion</h2>
    <p>The static and post-analysis confirmed that the malware was a sophisticated password and token stealer. It uses both local and network-based techniques to exfiltrate data to an attacker-controlled Discord webhook. In addition, it has self-cleaning mechanisms to avoid detection and analysis.</p>
    <p>Static analysis helped identify key functionality, while post-analysis provided insights into its dynamic behavior. Together, these techniques allowed us to fully understand the malware's capabilities and how to mitigate its effects.</p>
  </section>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 MoriDesuu. All Rights Reserved.</p>
  </footer>

</body>
</html>
